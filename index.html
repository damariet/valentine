<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Winning Autumn's Heart üíñ</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: black;
        font-family: "Courier New", monospace;
        text-align: center;
    }
    #startScreen {
        position: absolute;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, #ffccff, #ccffff, #ffffcc, #ffccff);
        background-size: 400% 400%;
        animation: rainbowShift 8s ease infinite;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        z-index: 10;
    }
    @keyframes rainbowShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
    button {
        padding: 15px 30px;
        font-size: 20px;
        border: 3px solid hotpink;
        background: black;
        color: hotpink;
        cursor: pointer;
        margin: 10px;
    }
    .controlZone {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 50%;
    }
    #leftZone { left: 0; }
    #rightZone { right: 0; }
    #controls {
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 20;
        display: none;
    }
    #gameArea {
        width: 100vw;
        height: 100vh;
        background: linear-gradient(to top, #120458, #000000);
        position: relative;
        overflow: hidden;
    }
    #score {
        position: absolute;
        top: 15px;
        width: 100%;
        color: cyan;
        font-size: 22px;
        z-index: 5;
        display: none;
    }
    .heart, .broken {
        position: absolute;
        font-size: 32px;
    }
    .heart { color:#ff00ff; }
    .broken { color:cyan; }
    #basket {
        position:absolute;
        bottom:20px;
        font-size:50px;
        color:cyan;
        display: none; /* hidden until game starts */
    }
    #valentineScreen {
        position:absolute;
        inset:0;
        background:black;
        color:hotpink;
        display:none;
        justify-content:center;
        align-items:center;
        flex-direction:column;
        z-index:20;
    }
</style>
</head>
<body>

<audio id="musicPlayer" loop>
    <source src="https://raw.githubusercontent.com/damariet/valentine/main/Chris_Brown_-_New_Flame_Feat._Usher_And_Rick_Ross_(mp3.pm).mp3" type="audio/mpeg">
</audio>
<audio id="catchSound">
    <source src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_6e6f8e3d44.mp3">
</audio>

<div id="startScreen">
    <h1>üíò Winning Autumn's Heart üíò</h1>
    <p>Loading love.exe...</p>
    <button onclick="startGame()">PRESS START</button>
</div>

<div id="score">LEVEL 1 ‚Äî LOVE: 0 / 5</div>

<div id="controls">
    <button id="pauseBtn">PAUSE</button>
    <button id="resumeBtn" style="display:none;">RESUME</button>
</div>

<div id="gameArea">
    <div id="basket">‚ñÇ‚ñÇ‚ñÇ</div>
</div>

<div id="valentineScreen">
    <h1>Autumn‚Ä¶ üíò</h1>
    <h2>Will you be my Valentine?</h2>
    <button id="yesBtn">YES</button>
    <button id="noBtn">NO</button>
</div>

<!-- Touch split‚Äëscreen zones -->
<div id="leftZone" class="controlZone"></div>
<div id="rightZone" class="controlZone"></div>

<script>
let score=0, level=1;
const basket = document.getElementById("basket");
const scoreDisplay = document.getElementById("score");
const musicPlayer = document.getElementById("musicPlayer");
const catchSound = document.getElementById("catchSound");
let basketX=window.innerWidth/2, gameLoop, moveDirection=0, isPaused=false;

// hide basket until start
basket.style.left = basketX+"px";
basket.style.display = "none";

// continuous movement loop
function moveBasket() {
    if (moveDirection!==0) {
        basketX += moveDirection * 10;
        basketX = Math.max(0, Math.min(window.innerWidth - basket.offsetWidth, basketX));
        basket.style.left = basketX+"px";
    }
    requestAnimationFrame(moveBasket);
}
moveBasket();

// Start game
function startGame() {
    document.getElementById("startScreen").style.display="none";
    scoreDisplay.style.display="block";
    document.getElementById("controls").style.display="block";
    basket.style.display="block";
    smoothFadeInMusic(10);
    updateScore();
    gameLoop = setInterval(createHeart, 600 - level*100);
}

// touch zones
document.getElementById("leftZone").addEventListener("touchstart", ()=> moveDirection=-1);
document.getElementById("leftZone").addEventListener("touchend", ()=> moveDirection=0);
document.getElementById("rightZone").addEventListener("touchstart", ()=> moveDirection=1);
document.getElementById("rightZone").addEventListener("touchend", ()=> moveDirection=0);

// Pause/Resume
const pauseBtn = document.getElementById("pauseBtn");
const resumeBtn = document.getElementById("resumeBtn");

pauseBtn.addEventListener("click", () => {
    if (!isPaused) {
        togglePause();
        musicPlayer.pause();
        pauseBtn.style.display="none";
        resumeBtn.style.display="inline-block";
    }
});
resumeBtn.addEventListener("click", () => {
    if (isPaused) {
        togglePause();
        musicPlayer.play();
        resumeBtn.style.display="none";
        pauseBtn.style.display="inline-block";
    }
});
function togglePause() {
    isPaused = !isPaused;
    if (isPaused) clearInterval(gameLoop);
    else gameLoop = setInterval(createHeart, 600 - level*100);
}

// auto‚Äëpause on tab hide
document.addEventListener("visibilitychange", () => {
    if (document.hidden) {
        if (!musicPlayer.paused) musicPlayer.pause();
    }
});

// scoring
function updateScore(){
    const targets=[5,10,15];
    scoreDisplay.innerText = `LEVEL ${level} ‚Äî LOVE: ${score} / ${targets[level-1]}`;
}

function nextLevel(){
    level++; score=0;
    if(level>3){
        clearInterval(gameLoop);
        showValentine();
        return;
    }
    updateScore();
}

function createHeart(){
    if(isPaused) return;
    let heart=document.createElement("div");
    let isBroken=Math.random()<(0.2+level*0.15);
    heart.innerHTML=isBroken?"üíî":"‚ô•";
    heart.className=isBroken?"broken":"heart";
    heart.style.left=Math.random()*(window.innerWidth-40)+"px";
    heart.style.top="-30px";
    document.getElementById("gameArea").appendChild(heart);

    let speed=3+level*2;
    let fall=setInterval(()=>{
        if(isPaused) return;
        heart.style.top=heart.offsetTop+speed+"px";
        if(heart.offsetTop>window.innerHeight-100 &&
            Math.abs(heart.offsetLeft-basketX)<50){
            score+=isBroken?-1:1;
            score=Math.max(0,score);
            catchSound.currentTime=0;
            catchSound.play();
            heart.remove();
            clearInterval(fall);
            updateScore();
            if((level===1&&score>=5)||(level===2&&score>=10)||(level===3&&score>=15)) nextLevel();
        }
        if(heart.offsetTop>window.innerHeight){
            heart.remove();
            clearInterval(fall);
        }
    },30);
}

// music fade‚Äëin
function smoothFadeInMusic(duration){
    musicPlayer.volume = 0;
    musicPlayer.play().catch(()=>{});
    let step=1/(duration*20);
    let fadeInt=setInterval(()=>{
        if(musicPlayer.volume<1) musicPlayer.volume=Math.min(musicPlayer.volume+step,1);
        else clearInterval(fadeInt);
    },50);
}

function showValentine(){
    document.getElementById("valentineScreen").style.display="flex";
}

document.getElementById("yesBtn").onclick=()=>{
    document.getElementById("valentineScreen").innerHTML=`
      <h1>YOU WON MY HEART üíò</h1>
      <h2>Happy Valentine‚Äôs Day! üíò</h2>
      <button onclick="resetGame()">RESTART</button>`;
};

let noBtnMoves=0;
const noBtn=document.getElementById("noBtn");
noBtn.onmouseover=()=>{
    if(noBtnMoves>=3)return;
    noBtn.style.position="absolute";
    const maxX=valentineScreen.offsetWidth-noBtn.offsetWidth;
    const maxY=valentineScreen.offsetHeight-noBtn.offsetHeight;
    noBtn.style.left=Math.random()*maxX+"px";
    noBtn.style.top=Math.random()*maxY+"px";
    noBtnMoves++;
    if(noBtnMoves>=3) noBtn.onclick=showFinalNoMessage;
};
function showFinalNoMessage(){
    document.getElementById("valentineScreen").innerHTML=`
      <h1>Oh you thought you could say NO? üòè</h1>
      <h2>Happy Valentine‚Äôs Day! üíò</h2>
      <button onclick="resetGame()">RESTART</button>`;
}
function resetGame(){
    musicPlayer.pause();
    musicPlayer.currentTime=0;
    level=1; score=0; noBtnMoves=0;
    document.getElementById("controls").style.display="none";
    document.getElementById("valentineScreen").style.display="none";
    basket.style.display="none";
    document.getElementById("startScreen").style.display="flex";
}
</script>

</body>
</html>

