<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Play Me üíñ</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: black;
  overflow: hidden;
  font-family: Arial, sans-serif;
}

/* SCREENS */
.screen {
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  text-align: center;
  z-index: 1;
}


/* START SCREEN */
#startScreen {
  background: linear-gradient(45deg,#ffccff,#ccffff,#ffffcc,#ffccff);
  background-size:400% 400%;
  animation:rainbowShift 8s ease infinite;
}

@keyframes rainbowShift {
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

#startScreen h1 {
  font-size: 6vw;
  color: hotpink;
}

/* TUTORIAL */
#tutorialOverlay {
  display: none;
  background: rgba(0,0,0,0.85);
  color: cyan;
  font-size: 4.5vw;
  padding: 20px;
}

/* GAME AREA */
#gameArea {
  display: none;
  background: linear-gradient(to top,#120458,#000);
}

#score {
  position: absolute;
  top: 10px;
  width: 100%;
  text-align: center;
  color: cyan;
  font-size: 4.5vw;
}

#controls {
  position: absolute;
  top: 10px;
  right: 10px;
}

.heart, .broken {
  position: absolute;
  font-size: 7vw;
}

.heart { color: #ff00ff; }
.broken { color: cyan; }

/* SMALLER BASKET */
#basket {
  position: absolute;
  bottom: 15px;
  font-size: 4vw;
  color: cyan;
}

/* LEVEL UP */
#levelUpBanner {
  position: absolute;
  inset: 0;
  display: none;
  justify-content: center;
  align-items: center;
  font-size: 10vw;
  font-weight: bold;
  color: hotpink;
}

/* VALENTINE */
#valentineScreen {
  display: none;
  background: black;
  color: hotpink;
  font-size: 5vw;
}

button {
  padding: 10px 20px;
  font-size: 4vw;
  border: 3px solid hotpink;
  background: black;
  color: hotpink;
  cursor: pointer;
  margin: 10px;
}
</style>
</head>

<body>

<audio id="musicPlayer" loop>
  <source src="https://raw.githubusercontent.com/damariet/valentine/main/Chris_Brown_-_New_Flame_Feat._Usher_And_Rick_Ross_(mp3.pm).mp3" type="audio/mpeg">
</audio>

<div id="startScreen" class="screen">
  <h1>üíò Play ME üíò</h1>
  <button onclick="showTutorial()">PRESS START</button>
</div>

<div id="tutorialOverlay" class="screen">
  <div>Drag left or right to move the basket.</div>
  <button onclick="startGame()">Got it!</button>
</div>

<div id="gameArea" class="screen">
  <div id="score"></div>

  <div id="controls">
    <button onclick="pauseGame()">Pause</button>
    <button onclick="resumeGame()">Resume</button>
  </div>

  <div id="basket">‚ñÇ‚ñÇ‚ñÇ</div>
  <div id="levelUpBanner"></div>
</div>

<div id="valentineScreen" class="screen"></div>

<script>
let score=0, level=1;
let gameLoop;
let noReturn;
let isPaused=false;

const targets=[5,10,15];

const basket=document.getElementById("basket");
const scoreDisplay=document.getElementById("score");
const levelUpBanner=document.getElementById("levelUpBanner");
const gameArea=document.getElementById("gameArea");
const musicPlayer=document.getElementById("musicPlayer");

/* STOP MUSIC IF USER LEAVES TAB */
document.addEventListener("visibilitychange", function(){
  if(document.hidden){
    musicPlayer.pause();
  }
});

/* START FLOW */
function showTutorial(){
  document.getElementById("startScreen").style.display="none";
  document.getElementById("tutorialOverlay").style.display="flex";
}

function startGame(){
  document.getElementById("tutorialOverlay").style.display="none";
  gameArea.style.display="flex";
  musicPlayer.play().catch(()=>{});
  updateScore();
  gameLoop=setInterval(createHeart,700-level*100);
}

function updateScore(){
  scoreDisplay.innerText=`LEVEL ${level} ‚Äî LOVE: ${score} / ${targets[level-1]}`;
}

/* PAUSE / RESUME */
function pauseGame(){
  isPaused=true;
  clearInterval(gameLoop);
  musicPlayer.pause();
}

function resumeGame(){
  if(!isPaused) return;
  isPaused=false;
  musicPlayer.play().catch(()=>{});
  gameLoop=setInterval(createHeart,700-level*100);
}

/* BASKET MOVEMENT */
let basketX=window.innerWidth/2;
basket.style.left=basketX+"px";

document.addEventListener("mousemove",e=>{
  basketX=e.clientX;
  basket.style.left=basketX+"px";
});

document.addEventListener("touchmove",e=>{
  basketX=e.touches[0].clientX;
  basket.style.left=basketX+"px";
},{passive:false});

/* HEARTS */
function createHeart(){
  if(isPaused) return;

  let h=document.createElement("div");
  let broken=Math.random()<(0.2+level*0.15);
  h.innerText=broken?"üíî":"‚ô•";
  h.className=broken?"broken":"heart";
  h.style.left=Math.random()*(window.innerWidth-40)+"px";
  h.style.top="-30px";
  gameArea.appendChild(h);

  let fall=setInterval(()=>{
    if(isPaused) return;

    h.style.top=h.offsetTop+(2+level*1.5)+"px;

    let hr=h.getBoundingClientRect();
    let br=basket.getBoundingClientRect();

    if(hr.left<br.right && hr.right>br.left && hr.bottom>=br.top){
      if(!broken) score++;
      else score=Math.max(0,score-1);
      h.remove();
      clearInterval(fall);
      updateScore();
      if(score>=targets[level-1]) levelUp();
    }

    if(h.offsetTop>window.innerHeight){
      h.remove();
      clearInterval(fall);
    }
  },30);
}

/* LEVEL UP */
function levelUp(){
  clearInterval(gameLoop);
  if(level<3){
    level++;
    score=0;
    showLevelUp(level);
    setTimeout(()=>{
      updateScore();
      gameLoop=setInterval(createHeart,700-level*100);
    },1200);
  } else {
    showValentine();
  }
}

function showLevelUp(num){
  levelUpBanner.innerText=`LEVEL ${num}!`;
  levelUpBanner.style.display="flex";
  setTimeout(()=>{levelUpBanner.style.display="none";},1000);
}

/* VALENTINE */
function showValentine(){
  gameArea.style.display="none";
  const v=document.getElementById("valentineScreen");
  v.style.display="flex";
  v.innerHTML=`
    <h1>Autumn‚Ä¶ üíò</h1>
    <h2>Will you be my Valentine?</h2>
    <button onclick="yes()">YES</button>
    <button onclick="startNoCountdown()">NO</button>
    <div id="noCountdown"></div>
  `;
}

function startNoCountdown(){
  const screen=document.getElementById("valentineScreen");

  screen.innerHTML=`
    <h1>Oh you thought you could say NO? üòè</h1>
    <h2>Happy Valentine‚Äôs Day! üíò</h2>
    <div id="noCountdown">Returning in 5</div>
  `;

  let count=5;

  noReturn=setInterval(()=>{
    count--;
    document.getElementById("noCountdown").innerText="Returning in "+count;

    if(count<=0){
      clearInterval(noReturn);
      showValentine();
    }
  },1000);
}

/* YES + RESTART */
function yes(){
  document.getElementById("valentineScreen").innerHTML=`
    <h1>YOU WON MY HEART üíò</h1>
    <h2>Happy Valentine‚Äôs Day! üíò</h2>
    <button onclick="resetGame()">RESTART</button>
  `;
}

function resetGame(){
  score=0;
  level=1;
  clearInterval(gameLoop);
  musicPlayer.pause();
  musicPlayer.currentTime=0;

  document.getElementById("valentineScreen").style.display="none";
  gameArea.style.display="none";
  document.getElementById("tutorialOverlay").style.display="none";
  document.getElementById("startScreen").style.display="flex";
}
</script>

</body>
</html>



